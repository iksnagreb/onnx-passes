# Import additional python modules dynamically before running the pass manager
# with the sequence of ONNX IR passes
imports: [  ]
# Reference data for verification and analysis: Inputs, expected outputs, ...
reference:
  inp: [ inp.npy ]
  out: [ out.npy ]
# [Experimental] Annotate layout assumptions and permutation/conversion for
# graph inputs and outputs
layouts:
  # Assume the input to be an image in channels-first layout "NCHW" which is
  # permuted to channels-last layout "NHWC" matching the lowered convolution
  inp:
    - { assumes: [ N, C, H, W ], perm: [ 0, 2, 3, 1 ] }
  # Assume the same on the output, which seems odd, but in this demo case
  # results in streamlining turning the output layout converter into the inverse
  # of the input layout converter, which nicely demonstrates as graph segment
  # sandwiched between matching layout converters and absorbing remaining
  # transposes from convolution lowering
  out:
    - { assumes: [ N, C, H, W ], perm: [ 0, 2, 3, 1 ] }
# Configuration of the model checker pass: Options according to the ONNX IR
# reference: https://onnx.ai/ir-py/api/ir_passes_common.html
model_checker:
  full_check: true
# Configuration of the shape inference pass: Options according to the ONNX IR
# reference: https://onnx.ai/ir-py/api/ir_passes_common.html
shape_inference: { }
# Configuration ONNX Runtime used for model evaluation during verification and
# analysis passes - see the ONNX Runtime API documentation for details:
#   https://onnxruntime.ai/docs/api/python/api_summary.html#inferencesession
onnxruntime:
  # Execution providers for accelerated inference
  providers:
    - - CPUExecutionProvider
      - { }
  # Produce a full execution context dump
  full_context_dump: false
# Configuration of model verification methods
verify:
  # Tolerance-based verification, parameters passed to np.allclose(...)
  tolerance:
    atol: 1.0e-6
  # Metric-based verification
  metrics:
    # Maximum Absolute Error over all outputs
    max_abs_error: [ 0.0, 0.01 ]
# Configuration of logging and verbosity
logging:
  # Enable all passes to print a message when entering/leaving
  verbose: false
  # Name to use for checkpoints - or to disable checkpointing
  checkpoint: false
  # Keeps intermediate models after each pass - path to some logging directory
  keep_intermediates: false
# Keep applying the passes exhaustively until the model stops changing
exhaustive: false
